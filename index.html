<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D Sphere with Matplotlib and Math in Pyodide</title>
    <script src="https://cdn.jsdelivr.net/npm/pyodide@0.22.0/pyodide.js"></script>
    <script type="text/javascript">
        async function runPython() {
            try {
                // Load Pyodide
                const pyodide = await loadPyodide();

                // Load necessary Python packages
                await pyodide.loadPackage(["numpy", "matplotlib"]);

                // Define Python script for generating 3D sphere data
                const pythonScript = `
import numpy as np
import matplotlib.pyplot as plt
from mpl_toolkits.mplot3d import Axes3D
import math

# Tạo dữ liệu hình cầu
theta = np.linspace(0, 2 * math.pi, 100)
phi = np.linspace(0, math.pi, 100)
theta, phi = np.meshgrid(theta, phi)

# Tọa độ hình cầu
r = 3  # bán kính
X = r * np.sin(phi) * np.cos(theta)
Y = r * np.sin(phi) * np.sin(theta)
Z = r * np.cos(phi)

# Vẽ hình cầu 3D
fig = plt.figure()
ax = fig.add_subplot(111, projection='3d')
ax.plot_surface(X, Y, Z, cmap='cool')

# Lưu hình ảnh vào bộ nhớ dưới dạng PNG
img_path = '/tmp/sphere.png'
fig.savefig(img_path)

# Trả về đường dẫn hình ảnh
img_path
                `;

                // Run Python code in Pyodide and get image path
                const imgPath = await pyodide.runPythonAsync(pythonScript);

                // Load the image and display it
                const img = new Image();
                img.src = URL.createObjectURL(await fetch(imgPath).then(res => res.blob()));
                img.onload = () => {
                    document.getElementById('plotly-graph').appendChild(img);
                };
            } catch (error) {
                console.error("Error running Python script:", error);
            }
        }

        // Run Python code when the page is loaded
        window.onload = runPython;
    </script>
</head>
<body>
    <h1>3D Sphere Visualization with Matplotlib and Math in Pyodide</h1>
    <div id="plotly-graph"></div>
</body>
</html>
